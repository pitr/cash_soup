<html>
<head>
<title>nice</title>
<link rel="stylesheet" href="style.css" TYPE="text/css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://graupel.oanda.com:8080/hackto/fxtrade.js"></script>
<script type="text/javascript" src="fux.js"></script>
<script language="javascript" src="processing.init.js"></script>
<script language="javascript" src="processing.js"></script>
</head>
<body>


<div id="wrapper">
	<div id="prompt" style="display:none">

	</div>
	<div id="splash">
		<h1>CASH SS$OUP! (WTF?)<br/><br/><br/> PLEASE STAND BY</h1>
	</div>

	<div id="main" style="display:none">

    <script type="application/processing">
    // Global variables
    console.log('start start');
    int NUM = symbols.length;
    Spore SPORES = new Spore[NUM];
    int DELAY = 70;
    console.log('end start');

    class Spore {
      float R, nR; // current/new radius
      float B, nB; // current/new border margin
      int X, Y; // current location
      int nX, nY; // new location
      Object symbol;
      float scale;

      Spore(Object key) {
        console.log('start init');
        symbol = key;
        scale = symbol.scale;
        R = 0.0;
        nR = R;
        B = 0.0;
        nB = B;
        X = width / 2 + int(random(-200,200));
        Y = height / 2 + int(random(-200,200));
        nX = X;
        nY = Y;
        console.log('end init');
      }

      void draw() {
        update();

        R += (nR-R)/DELAY;
        B += (nB-B)/DELAY;

        // Track circle to new destination
        X += (nX-X)/DELAY;
        Y += (nY-Y)/DELAY;

        // Draw circle
        fill( 253, 253, 253, 99 ); // outer (white)
        ellipse( X, Y, R+B, R+B );
        fill( 0, 1, 81, 103 ); // inner (blue)
        ellipse( X, Y, R, R );
      }

      void update() {
        if(symbol.data) {
          //console.log(symbol.data.ask);
          float ask = symbol.data.ask;
          setRadius((ask-scale)*100000);
          B = 2.0;
        }
      }

      // move towards (x,y)
      void move(int x, int y) {
        nX = x;
        nY = y;
      }

      void setRadius(float r) {
        nR = r;
      }

      void setBorder(float b) {
        nB = b;
      }
    }

    // Setup the Processing Canvas
    void setup(){
      size( 1000, 500 );
      noStroke();
      frameRate( 30 );
      for(int i=0; i<NUM; i++) {
        SPORES[i] = new Spore(symbols[i]);
        SPORES[i].setRadius( 0.0 );
        SPORES[i].setBorder( 0.0 );
      }
    }

    // Main draw loop
    void draw(){
      // Fill canvas grey
      background( 100 );

      for(int i=0; i<NUM; i++) {
        SPORES[i].draw();
      }
    }
    </script>

    <canvas width='1000' height='500'></canvas>

		<table id="datatable">
			<thead>
				<tr>
					<th>KEY</th>
					<th>ASK</th>
				</tr>
			</thead>
			<tbody>
				<script>
					$.each(symbols,
						function(i, symbol) {
							document.write('<tr data-symbol="'+symbol.key+'"><td>'+symbol.key+'</td><td class="ask">--</td></tr>');
						}
					);
				</script>
			</tbody>
		</table>
	</div>
</div>



</body>
</html>